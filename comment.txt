'Дата доставки - это не максимальный state_datetime
Заказ может быть в пути, а может быть и возвращен'

Мне казалось в этом и смысл - видеть все статусы, вот так сформулировано задание:
 
 'Данные в таблице должны отражать максимальный status и state по
 максимальному времени лога state_datetime в таблице shipping.'
 
 + во вьюхе есть поле:
 
 'is_shipping_finish — статус, показывающий, что доставка завершена.
 Если финальный status = finished → 1; 0'
 
 Если мы отберем только доставленные, то получим в этом поле только 1.
 
 